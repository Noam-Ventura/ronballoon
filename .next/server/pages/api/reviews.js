"use strict";(()=>{var e={};e.id=534,e.ids=[534],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},2251:(e,t,r)=>{r.r(t),r.d(t,{config:()=>l,default:()=>u,routeModule:()=>d});var i={};r.r(i),r.d(i,{default:()=>s});var a=r(1802),n=r(7153),o=r(6249);async function s(e,t){if("GET"!==e.method)return t.setHeader("Allow","GET"),t.status(405).json({ok:!1,error:"Method not allowed"});let r=process.env.GOOGLE_PLACES_API_KEY,i="ChIJAYDq0585HRURlj5YCHc0xC8";if(!r||!i)return t.status(200).json({ok:!1,error:"Missing API key or place id"});try{let a;let n="1"===String(e.query.withReviews||"0"),o=["rating","user_ratings_total","url"];n&&o.push("reviews");let s=new URLSearchParams({place_id:i,fields:o.join(","),key:r,language:"he",reviews_sort:"most_relevant",reviews_no_translations:"false"}),u=`https://maps.googleapis.com/maps/api/place/details/json?${s.toString()}`,l=await fetch(u);if(!l.ok)throw Error("Failed to fetch");let d=await l.json(),p=d?.result,f=Number(p?.rating??0),c=Number(p?.user_ratings_total??0),P=p?.url;if(n&&Array.isArray(p?.reviews)&&(a=p.reviews.filter(e=>e?.text&&e?.rating).map(e=>({authorName:e.author_name,text:e.text,rating:Number(e.rating)||0,relativeTime:e.relative_time_description,profilePhotoUrl:e.profile_photo_url})).slice(0,8)),!f||!c)return t.status(200).json({ok:!1,error:"No rating data"});return t.status(200).json({ok:!0,rating:f,total:c,url:P,reviews:a})}catch(e){return t.status(200).json({ok:!1,error:"Unexpected error"})}}let u=(0,o.l)(i,"default"),l=(0,o.l)(i,"config"),d=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/reviews",pathname:"/api/reviews",bundlePath:"",filename:""},userland:i})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=2251);module.exports=r})();